<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advance Visualizations tools</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/luckysheet@latest/dist/plugins/css/pluginsCss.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/luckysheet@latest/dist/plugins/plugins.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/luckysheet@latest/dist/css/luckysheet.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/luckysheet@latest/dist/assets/iconfont/iconfont.css" />
    
    <link href="https://cdn.quilljs.com/1.3.7/quill.snow.css" rel="stylesheet" />
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/theme/dracula.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/lint/lint.min.css">
    <link rel="stylesheet" href="src/css/dark_theam.css" />
    <link rel="stylesheet" href="src/css/core.css" />
    <link rel="stylesheet" href="src/css/editor_templates.css" />
    
    <link rel="stylesheet" href="src/css/ai_advice.css"/>
    <link rel="stylesheet" href="src/css/all.css"/>
    <link rel="stylesheet" href="src/css/small_menubarall.css"/>
    <link rel="stylesheet" href="src/css/dataTebledisplay.css">
    <link rel="stylesheet" href="src/css/editor_templates.css"/>
</head>
<body>
    <div class="title-bar">
        Advance Visualizations Tools
    </div>

    <nav class="main-menu-bar">
        <a href="#" class="nav-link" id="menuData" data-bs-toggle="modal" data-bs-target="#mainMenuModal" data-menu-target="dataContent">
            <i class="bi bi-file-earmark-arrow-up"></i>
            <span>Data</span>
        </a>
        <a href="#" class="nav-link" id="menuCharts" data-bs-toggle="offcanvas" data-bs-target="#offcanvasSidebar" data-menu-target="chartSettingsContent">
            <i class="bi bi-bar-chart"></i>
            <span>Chart</span>
        </a>
        <a href="#" class="nav-link" id="menuAdvancedSettings" data-bs-toggle="modal" data-bs-target="#mainMenuModal" data-menu-target="advancedSettingsContent">
            <i class="bi bi-sliders"></i>
            <span>Advance Settings</span>
        </a>
        <a href="#" class="nav-link" id="menuDataStatistics" data-bs-toggle="modal" data-bs-target="#mainMenuModal" data-menu-target="dataStatisticsContent">
            <i class="bi bi-calculator"></i>
            <span>‡§°‡•á‡§ü‡§æ ‡§∏‡§æ‡§Ç‡§ñ‡•ç‡§Ø‡§ø‡§ï‡•Ä</span>
        </a>
        <a href="#" class="nav-link" id="menuAdditionalActions" data-bs-toggle="offcanvas" data-bs-target="#offcanvasSidebar" data-menu-target="additionalActionsContent">
            <i class="bi bi-gear"></i>
            <span>‡§Ö‡§§‡§ø‡§∞‡§ø‡§ï‡•ç‡§§ ‡§ï‡§æ‡§∞‡•ç‡§Ø</span>
        </a>
        <a href="#" class="nav-link" id="menuFilterSort" data-bs-toggle="offcanvas" data-bs-target="#offcanvasSidebar" data-menu-target="filterSortContent">
            <i class="bi bi-filter"></i>
            <span>‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§è‡§µ‡§Ç ‡§∏‡•â‡§∞‡•ç‡§ü</span>
        </a>
        <a href="#" class="nav-link" id="menuDashboardView" data-bs-toggle="modal" data-bs-target="#mainMenuModal" data-menu-target="dashboardViewContent">
            <i class="bi bi-eye"></i>
            <span>‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§° ‡§µ‡•ç‡§Ø‡•Ç</span>
        </a>
        <a href="#" class="nav-link" id="menuChartFormatting" data-bs-toggle="offcanvas" data-bs-target="#offcanvasSidebar" data-menu-target="chartFormattingContent">
            <i class="bi bi-brush"></i>
            <span>‡§ö‡§æ‡§∞‡•ç‡§ü ‡§´‡•â‡§∞‡•ç‡§Æ‡•á‡§ü‡§ø‡§Ç‡§ó</span>
        </a>
        <a href="#" class="nav-link" id="menuChartEffects" data-bs-toggle="offcanvas" data-bs-target="#offcanvasSidebar" data-menu-target="chartEffectsContent">
            <i class="bi bi-magic"></i>
            <span>‡§ö‡§æ‡§∞‡•ç‡§ü ‡§á‡§´‡§º‡•á‡§ï‡•ç‡§ü</span>
        </a>
        <a href="#" class="nav-link" id="menuTextbox" data-bs-toggle="offcanvas" data-bs-target="#offcanvasSidebar" data-menu-target="textboxContent">
            <i class="bi bi-textarea-t"></i>
            <span>‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü‡§¨‡•â‡§ï‡•ç‡§∏</span>
        </a>
        <a href="#" class="nav-link" id="menuUserInfo" data-bs-toggle="offcanvas" data-bs-target="#offcanvasSidebar" data-menu-target="userInfoContent">
            <i class="bi bi-person-circle"></i>
            <span>‡§™‡•ç‡§∞‡•ã‡§´‡§º‡§æ‡§á‡§≤</span>
        </a>
    </nav>
    
    <nav class="small-menu-bar">
        <div class="btn-group" role="group" aria-label="Small menu bar buttons">
            <button id="toggleTheme" class="btn btn-secondary"><i class="bi bi-moon"></i> ‡§•‡•Ä‡§Æ ‡§¨‡§¶‡§≤‡•á‡§Ç</button>
            <button id="downloadTemplate" class="btn btn-info"><i class="bi bi-download"></i> ‡§ü‡•á‡§Æ‡•ç‡§™‡§≤‡•á‡§ü ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç</button>
            <button id="editDataBtn" class="btn btn-warning" onclick="window.location.href='edit_data.html';">
                <i class="bi bi-pencil-square"></i> ‡§°‡•á‡§ü‡§æ ‡§è‡§°‡§ø‡§ü ‡§ï‡§∞‡•á‡§Ç (Excel ‡§ú‡•à‡§∏‡§æ)
            </button>
            <button id="addDataBtn" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addDataModal">
                <i class="bi bi-plus-square"></i> ‡§®‡§Ø‡§æ ‡§°‡•á‡§ü‡§æ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç
            </button>
        </div>
    </nav>
    
    <div id="loadingOverlay">
        <div class="spinner"></div>
        <div id="loadingText">Loading vedra bi</div>
    </div>    

    <div id="dashboardContent">
        <div class="offcanvas offcanvas-end bg-light" tabindex="-1" id="offcanvasSidebar" aria-labelledby="offcanvasSidebarLabel">
            <div class="offcanvas-header">
                <h5 class="offcanvas-title" id="offcanvasSidebarLabel">‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó‡•ç‡§∏</h5>
                <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
            </div>
            <div class="offcanvas-body">
                <div id="chartSettingsContent" class="offcanvas-content" style="display: none;">
                    <h5 class="mb-3"><i class="bi bi-bar-chart"></i> ‡§ö‡§æ‡§∞‡•ç‡§ü ‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó‡•ç‡§∏</h5>
                    <div id="chartSettingsSection">
                        <div class="row gy-3 mb-4">
                            <div class="col-md-12">
                                <label class="form-label"><i class="bi bi-bar-chart"></i> ‡§ö‡§æ‡§∞‡•ç‡§ü ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ ‡§ö‡•Å‡§®‡•á‡§Ç:</label>
                                <!div id="chartTypeGallery" class="d-flex flex-wrap justify-content-center gap-2">
                                    <!/div>
                                    <div id="chartTypeGallery" class="d-flex flex-wrap justify-content-center gap-2">
</div>
                            </div>
                            <div class="col-md-12 mt-3 text-center">
                                <img id="selectedChartDisplayImage" src="" alt="‡§ö‡§Ø‡§®‡§ø‡§§ ‡§ö‡§æ‡§∞‡•ç‡§ü" class="img-fluid" style="max-width: 300px; display: none;">
                            </div>
                            <select id="chartType" class="form-select d-none">
                                <option value="bar">‡§¨‡§æ‡§∞ ‡§ö‡§æ‡§∞‡•ç‡§ü</option>
                                <option value="stacked-bar">‡§∏‡•ç‡§ü‡•à‡§ï‡•ç‡§° ‡§¨‡§æ‡§∞</option>
                                <option value="horizontal-bar">‡§π‡•â‡§∞‡§ø‡§ú‡•â‡§®‡•ç‡§ü‡§≤ ‡§¨‡§æ‡§∞</option>
                                <option value="grouped-bar">‡§ó‡•ç‡§∞‡•Å‡§™‡•ç‡§° ‡§¨‡§æ‡§∞</option>
                                <option value="bar3D">3D ‡§¨‡§æ‡§∞ ‡§ö‡§æ‡§∞‡•ç‡§ü</option>
                                <option value="line3D">3D line chart</option>
                                <option value="line">‡§≤‡§æ‡§á‡§® ‡§ö‡§æ‡§∞‡•ç‡§ü</option>
                                <option value="stacked-line">‡§∏‡•ç‡§ü‡•à‡§ï‡•ç‡§° ‡§≤‡§æ‡§á‡§®</option>
                                <option value="smooth-line">‡§∏‡•ç‡§Æ‡•Ç‡§¶ ‡§≤‡§æ‡§á‡§®</option>
                                <option value="step-line">‡§∏‡•ç‡§ü‡•á‡§™ ‡§≤‡§æ‡§á‡§®</option>
                                <option value="pie">‡§™‡§æ‡§à ‡§ö‡§æ‡§∞‡•ç‡§ü</option>
                                <option value="doughnut">‡§°‡•ã‡§®‡§ü ‡§ö‡§æ‡§∞‡•ç‡§ü</option>
                                <option value="rose-radius">‡§∞‡•ã‡§ú‡§º ‡§ö‡§æ‡§∞‡•ç‡§ü (Radius)</option>
                                <option value="rose-area">‡§∞‡•ã‡§ú‡§º ‡§ö‡§æ‡§∞‡•ç‡§ü (Area)</option>
                                <option value="scatter">‡§∏‡•ç‡§ï‡•à‡§ü‡§∞ ‡§ö‡§æ‡§∞‡•ç‡§ü</option>
                                <option value="bubble">‡§¨‡§¨‡§≤ ‡§ö‡§æ‡§∞‡•ç‡§ü</option>
                                <option value="funnel">‡§´‡§º‡§®‡•á‡§≤ ‡§ö‡§æ‡§∞‡•ç‡§ü</option>
                                <option value="gauge">‡§ó‡•á‡§ú ‡§ö‡§æ‡§∞‡•ç‡§ü</option>
                                <option value="radar">‡§∞‡§æ‡§°‡§æ‡§∞ ‡§ö‡§æ‡§∞‡•ç‡§ü</option>
                                <option value="treemap">‡§ü‡•ç‡§∞‡•Ä‡§Æ‡•à‡§™ ‡§ö‡§æ‡§∞‡•ç‡§ü</option>
                                <option value="candlestick">‡§ï‡•à‡§Ç‡§°‡§≤‡§∏‡•ç‡§ü‡§ø‡§ï ‡§ö‡§æ‡§∞‡•ç‡§ü (Plotly)</option>
                                <option value="ohlc">OHLC ‡§ö‡§æ‡§∞‡•ç‡§ü (Plotly)</option>
                            </select>
                            
                            <div class="col-md-12 mt-3">
                                <label class="form-label"><i class="bi bi-grip-horizontal"></i> ‡§∏‡§≠‡•Ä ‡§ï‡•â‡§≤‡§Æ (‡§°‡•ç‡§∞‡•à‡§ó ‡§ï‡§∞‡•á‡§Ç):</label>
                                <div id="columnList" class="drag-container list-group mb-3">
                                    </div>
                            </div>
                            <div class="col-md-12 mt-3">
                                <label class="form-label"><i class="bi bi-x-axis"></i> X-‡§Ö‡§ï‡•ç‡§∑ (‡§°‡•ç‡§∞‡•â‡§™ ‡§ï‡§∞‡•á‡§Ç):</label>
                                <div id="xAxisDropZone" class="drop-zone drag-container list-group mb-3"></div>
                            </div>
                            <div class="col-md-12 mt-3">
                                <label class="form-label"><i class="bi bi-y-axis"></i> Y-‡§Ö‡§ï‡•ç‡§∑ (‡§°‡•ç‡§∞‡•â‡§™ ‡§ï‡§∞‡•á‡§Ç):</label>
                                <div id="yAxisDropZone" class="drop-zone drag-container list-group mb-3"></div>
                            </div>
                            <div class="col-md-12 mt-3" id="zAxisDropZoneContainer" style="display: none;">
                                <label class="form-label"><i class="bi bi-arrow-up-right-dots"></i> Z-‡§Ö‡§ï‡•ç‡§∑ (‡§°‡•ç‡§∞‡•â‡§™ ‡§ï‡§∞‡•á‡§Ç):</label>
                                <div id="zAxisDropZone" class="drop-zone drag-container list-group mb-3"></div>
                            </div>

                            <div class="col-md-12 mt-3">
                                <label for="chartTitle" class="form-label"><i class="bi bi-type-h1"></i> ‡§ö‡§æ‡§∞‡•ç‡§ü ‡§∂‡•Ä‡§∞‡•ç‡§∑‡§ï:</label>
                                <input type="text" id="chartTitle" class="form-control" placeholder="‡§∂‡•Ä‡§∞‡•ç‡§∑‡§ï ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç">
                            </div>
                            <div class="col-md-12 mt-3">
                                <label for="xAxisLabel" class="form-label"><i class="bi bi-x-axis"></i> X-‡§Ö‡§ï‡•ç‡§∑ ‡§≤‡•á‡§¨‡§≤ (‡§µ‡•à‡§ï‡§≤‡•ç‡§™‡§ø‡§ï):</label>
                                <input type="text" id="xAxisLabel" class="form-control" placeholder="X-‡§Ö‡§ï‡•ç‡§∑ ‡§≤‡•á‡§¨‡§≤">
                            </div>
                            <div class="col-md-12 mt-3">
                                <label for="yAxisLabel" class="form-label"><i class="bi bi-y-axis"></i> Y-‡§Ö‡§ï‡•ç‡§∑ ‡§≤‡•á‡§¨‡§≤ (‡§µ‡•à‡§ï‡§≤‡•ç‡§™‡§ø‡§ï):</label>
                                <input type="text" id="yAxisLabel" class="form-control" placeholder="Y-‡§Ö‡§ï‡•ç‡§∑ ‡§≤‡•á‡§¨‡§≤">
                            </div>
                            <div class="col-md-12 mt-3">
                                <label for="colorPicker" class="form-label"><i class="bi bi-palette"></i> ‡§ö‡§æ‡§∞‡•ç‡§ü ‡§∞‡§Ç‡§ó (‡§è‡§ï‡§≤ ‡§∂‡•ç‡§∞‡•É‡§Ç‡§ñ‡§≤‡§æ):</label>
                                <input type="color" id="colorPicker" class="form-control form-control-color" value="#5470C6">
                            </div>
                            <div class="col-md-12 mt-3">
                                <button id="addVisualizationBtn" class="btn btn-primary w-100"><i class="bi bi-plus-circle"></i> ‡§µ‡§ø‡§ú‡§º‡•Å‡§Ö‡§≤‡§æ‡§á‡§ú‡§º‡•á‡§∂‡§® ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="additionalActionsContent" class="offcanvas-content" style="display: none;">
                    <h5 class="mb-3"><i class="bi bi-gear"></i> ‡§Ö‡§§‡§ø‡§∞‡§ø‡§ï‡•ç‡§§ ‡§ï‡§æ‡§∞‡•ç‡§Ø</h5>
                    <div id="additionalActions">
                        <div class="row gy-3 mb-4">
                            <div class="col-md-12">
                                <!button id="toggleTheme" class="btn btn-secondary w-100"><!i class="bi bi-moon"><!/i> ‡§•‡•Ä‡§Æ ‡§¨‡§¶‡§≤‡•á‡§Ç<!/button>
                            </div>
                            <div class="col-md-12">
                                <button id="downloadTemplate" class="btn btn-info w-100"><i class="bi bi-download"></i> ‡§ü‡•á‡§Æ‡•ç‡§™‡§≤‡•á‡§ü ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç</button>
                            </div>
                            <div class="col-md-12">
                                <button id="editDataBtn" class="btn btn-warning w-100" onclick="window.location.href='edit_data.html';">
                                    <i class="bi bi-pencil-square"></i> ‡§°‡•á‡§ü‡§æ ‡§è‡§°‡§ø‡§ü ‡§ï‡§∞‡•á‡§Ç (Excel ‡§ú‡•à‡§∏‡§æ)
                                </button>
                            </div>
                            <div class="col-md-12">
                                <button id="addDataBtn" class="btn btn-primary w-100" data-bs-toggle="modal" data-bs-target="#addDataModal"><i class="bi bi-plus-square"></i> ‡§®‡§Ø‡§æ ‡§°‡•á‡§ü‡§æ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</button>
                            </div>
                            <div class="col-md-12 mt-4">
                                <label class="form-label"><i class="bi bi-palette-fill"></i> ‡§¨‡•à‡§ï‡§ó‡•ç‡§∞‡§æ‡§â‡§Ç‡§° ‡§ü‡•á‡§Æ‡•ç‡§™‡§≤‡•á‡§ü‡•ç‡§∏ ‡§ö‡•Å‡§®‡•á‡§Ç:</label>
                                <div id="backgroundTemplateGallery" class="d-flex flex-wrap justify-content-center gap-3 mt-2">
                                    </div>
                                <div class="text-center mt-3">
                                    <button id="applyTemplateBtn" class="btn btn-success w-100"><i class="bi bi-check-circle"></i> ‡§ü‡•á‡§Æ‡•ç‡§™‡§≤‡•á‡§ü ‡§≤‡§æ‡§ó‡•Ç ‡§ï‡§∞‡•á‡§Ç</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

        
 <div id="filterSortContent" class="offcanvas-content" style="display: none;">
                    <h5 class="mb-3"><i class="bi bi-filter"></i> ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§è‡§µ‡§Ç ‡§∏‡•â‡§∞‡•ç‡§ü</h5>
                    <div id="filterSortSection">
                        <div class="row gy-3 mb-4">
                            <div class="col-md-12">
                                <label for="filterCol"><i class="bi bi-funnel"></i> ‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü ‡§ï‡•â‡§≤‡§Æ ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞:</label>
                                <select id="filterCol" class="form-select"></select>
                                <select id="textFilterOperator" class="form-select mt-2">
                                    <option value="includes">‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•à</option>
                                    <option value="startsWith">‡§∏‡•á ‡§∂‡•Å‡§∞‡•Ç ‡§π‡•ã‡§§‡§æ ‡§π‡•à</option>
                                    <option value="endsWith">‡§∏‡•á ‡§ñ‡§§‡•ç‡§Æ ‡§π‡•ã‡§§‡§æ ‡§π‡•à</option>
                                    <option value="equals">‡§ï‡•á ‡§¨‡§∞‡§æ‡§¨‡§∞ ‡§π‡•à</option>
                                    <option value="doesNotInclude">‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à</option>
                                </select>
                                <input type="text" id="filterValue" class="form-control mt-2" placeholder="‡§Æ‡§æ‡§® ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç">
                            </div>

                            <div class="col-md-12 mt-3">
                                <label for="multiSelectFilterCol"><i class="bi bi-list-check"></i> ‡§¨‡§π‡•Å-‡§ö‡§Ø‡§® ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞:</label>
                                <select id="multiSelectFilterCol" class="form-select"></select>
                                <div id="multiSelectOptions" class="mt-2" style="max-height: 150px; overflow-y: auto;">
                                    </div>
                            </div>

                            <div class="col-md-12 mt-3">
                                <label for="filterNumericCol"><i class="bi bi-graph-up-arrow"></i> ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ‡§§‡•ç‡§Æ‡§ï ‡§∞‡•á‡§Ç‡§ú ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞:</label>
                                <select id="filterNumericCol" class="form-select"></select>
                                <div class="input-group mt-2">
                                    <span class="input-group-text">‡§®‡•ç‡§Ø‡•Ç‡§®‡§§‡§Æ</span>
                                    <input type="number" id="minNumericValue" class="form-control" placeholder="‡§®‡•ç‡§Ø‡•Ç‡§®‡§§‡§Æ ‡§Æ‡§æ‡§®">
                                </div>
                                <div class="input-group mt-2">
                                    <span class="input-group-text">‡§Ö‡§ß‡§ø‡§ï‡§§‡§Æ</span>
                                    <input type="number" id="maxNumericValue" class="form-control" placeholder="‡§Ö‡§ß‡§ø‡§ï‡§§‡§Æ ‡§Æ‡§æ‡§®">
                                </div>
                            </div>
                            <div class="col-md-12 mt-3">
                                <label for="startDate"><i class="bi bi-calendar"></i> ‡§§‡§æ‡§∞‡•Ä‡§ñ ‡§∞‡•á‡§Ç‡§ú:</label>
                                <input type="date" id="startDate" class="form-control mb-2">
                                <input type="date" id="endDate" class="form-control">
                            </div>

                            <div class="col-md-12">
                                <label for="groupByCols"><i class="bi bi-list-ul"></i> ‡§ó‡•ç‡§∞‡•Å‡§™ ‡§¨‡§æ‡§Ø:</label>
                                <select id="groupByCols" multiple class="form-select" style="height:100px;"></select>
                            </div>

                            <div class="col-md-12 mt-4">
                                <label><i class="bi bi-sort-down-alt"></i> ‡§¨‡§π‡•Å-‡§ï‡•â‡§≤‡§Æ ‡§∏‡•â‡§∞‡•ç‡§ü:</label>
                                <div id="sortRulesContainer">
                                    </div>
                                <button id="addSortRuleBtn" class="btn btn-secondary w-100 mt-2"><i class="bi bi-plus"></i> ‡§è‡§ï ‡§î‡§∞ ‡§∏‡•â‡§∞‡•ç‡§ü ‡§®‡§ø‡§Ø‡§Æ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</button>
                            </div>

                            <div class="col-md-12 mt-4">
                                <label><i class="bi bi-box-seam"></i> ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§™‡•ç‡§∞‡•Ä‡§∏‡•á‡§ü:</label>
                                <div class="input-group">
                                    <input type="text" id="presetName" class="form-control" placeholder="‡§™‡•ç‡§∞‡•Ä‡§∏‡•á‡§ü ‡§®‡§æ‡§Æ">
                                    <button id="savePresetBtn" class="btn btn-success"><i class="bi bi-save"></i></button>
                                </div>
                                <select id="loadPreset" class="form-select mt-2">
                                    <option value="">‡§™‡•ç‡§∞‡•Ä‡§∏‡•á‡§ü ‡§ö‡•Å‡§®‡•á‡§Ç</option>
                                    </select>
                                <button id="applyPresetBtn" class="btn btn-primary mt-2 w-100"><i class="bi bi-check-circle"></i> ‡§™‡•ç‡§∞‡•Ä‡§∏‡•á‡§ü ‡§≤‡§æ‡§ó‡•Ç ‡§ï‡§∞‡•á‡§Ç</button>
                            </div>
                        </div>
<div class="row mb-3">
    <div class="col-12">
        <button type="button" id="resetFiltersBtn" class="btn btn-warning">
            <i class="bi bi-arrow-clockwise"></i> ‡§∏‡§≠‡•Ä ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞‡•ç‡§∏ ‡§∞‡•Ä‡§∏‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç
        </button>
    </div>
</div>
                        <button id="applyFilterSort" class="btn btn-secondary mt-3 w-100"><i class="bi bi-check-circle"></i> ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§î‡§∞ ‡§∏‡•â‡§∞‡•ç‡§ü ‡§≤‡§æ‡§ó‡•Ç ‡§ï‡§∞‡•á‡§Ç</button>
                    </div>
                </div>

 
                <div id="chartFormattingContent" class="offcanvas-content" style="display: none;">
                    <h5 class="mb-3"><i class="bi bi-brush"></i> ‡§ö‡§æ‡§∞‡•ç‡§ü ‡§´‡•â‡§∞‡•ç‡§Æ‡•á‡§ü‡§ø‡§Ç‡§ó</h5>
                    <div id="chartFormattingSection">
                        <div class="mb-3">
                            <label class="form-label"><i class="bi bi-palette"></i> ‡§ö‡§æ‡§∞‡•ç‡§ü ‡§ï‡§Ç‡§ü‡•á‡§®‡§∞ ‡§∞‡§Ç‡§ó ‡§ü‡•á‡§Æ‡•ç‡§™‡§≤‡•á‡§ü‡•ç‡§∏ ‡§ö‡•Å‡§®‡•á‡§Ç:</label>
                            <div id="chartContainerColorGallery" class="d-flex flex-wrap justify-content-center gap-3 mt-2">
                                </div>
                        </div>
                        <div class="text-center mt-3">
                            <div class="mb-3">
                                <label class="form-label"><i class="bi bi-paint-bucket"></i> ‡§ï‡§≤‡§∞ ‡§∏‡•ç‡§ï‡•ã‡§™ ‡§ö‡•Å‡§®‡•á‡§Ç:</label>
                                <div class="btn-group w-100" role="group">
                                    <input type="radio" class="btn-check" name="chartContainerScope" id="scopeAllCharts" autocomplete="off" checked>
                                    <label class="btn btn-outline-primary" for="scopeAllCharts">‡§∏‡§≠‡•Ä ‡§ö‡§æ‡§∞‡•ç‡§ü‡•ç‡§∏ ‡§™‡§∞</label>
                                    <input type="radio" class="btn-check" name="chartContainerScope" id="scopeSelectedCharts" autocomplete="off">
                                    <label class="btn btn-outline-primary" for="scopeSelectedCharts">‡§ö‡§Ø‡§®‡§ø‡§§ ‡§ö‡§æ‡§∞‡•ç‡§ü‡•ç‡§∏ ‡§™‡§∞</label>
                                </div>
                            </div>
                            <div id="dashboardChartOverview" style="display: none;">
                                <label class="form-label"><i class="bi bi-list-check"></i> ‡§ö‡§æ‡§∞‡•ç‡§ü ‡§ö‡•Å‡§®‡•á‡§Ç:</label>
                                <div id="chartSelectionList" class="form-control" style="max-height: 200px; overflow-y: auto;">
                                    </div>
                            </div>
                            <button id="applyChartContainerColorBtn" class="btn btn-success w-100 mt-3"><i class="bi bi-check-circle"></i> ‡§ï‡§Ç‡§ü‡•á‡§®‡§∞ ‡§∞‡§Ç‡§ó ‡§≤‡§æ‡§ó‡•Ç ‡§ï‡§∞‡•á‡§Ç</button>
                        </div>
                        <div class="col-md-12 mt-3">
                            <hr>
                            <h6>‡§ï‡§∏‡•ç‡§ü‡§Æ ‡§∞‡§Ç‡§ó ‡§î‡§∞ ‡§∂‡•à‡§≤‡•Ä</h6>
                            <p class="text-muted small">‡§Ø‡§π‡§æ‡§Å JSON ‡§´‡•â‡§∞‡•ç‡§Æ‡•á‡§ü ‡§Æ‡•á‡§Ç ‡§ï‡•ã‡§° ‡§°‡§æ‡§≤‡•á‡§Ç‡•§</p>
                            <div class="input-group">
                                <textarea id="customChartContainerCode" class="form-control" rows="12" placeholder="‡§â‡§¶‡§æ‡§π‡§∞‡§£: { 'style': { 'background': '#ff5733', 'color': '#ffffff' }, 'chartBackgroundColor': '#ff5733' }"></textarea>
                                <button class="btn btn-outline-secondary" type="button" id="openChartFormatEditorBtn" data-bs-toggle="modal" data-bs-target="#codeEditorModal"><i class="bi bi-arrows-fullscreen"></i></button>
                            </div>
                            <button id="applyCustomChartContainerCodeBtn" class="btn btn-primary w-100 mt-2"><i class="bi bi-code"></i> ‡§ï‡§∏‡•ç‡§ü‡§Æ ‡§∂‡•à‡§≤‡•Ä ‡§≤‡§æ‡§ó‡•Ç ‡§ï‡§∞‡•á‡§Ç</button>
                        </div>
                    </div>
                </div>
                <div id="chartEffectsContent" class="offcanvas-content" style="display: none;">    
    <h5 class="mb-3"><i class="bi bi-magic"></i> ‡§ö‡§æ‡§∞‡•ç‡§ü ‡§á‡§´‡•á‡§ï‡•ç‡§ü‡•ç‡§∏</h5>    
    <div id="chartEffectsSection">    
        <div class="mb-3">    
            <label class="form-label">‡§ö‡§æ‡§∞‡•ç‡§ü ‡§á‡•û‡•á‡§ï‡•ç‡§ü‡•ç‡§∏</label>    
            <div class="btn-group w-100" role="group" aria-label="‡§á‡•û‡•á‡§ï‡•ç‡§ü‡•ç‡§∏ ‡§µ‡§ø‡§ï‡§≤‡•ç‡§™">    
                <input type="radio" class="btn-check" name="effectsOption" id="customEffectsRadio" autocomplete="off" checked>    
                <label class="btn btn-outline-primary" for="customEffectsRadio">‡§ï‡§∏‡•ç‡§ü‡§Æ ‡§á‡•û‡•á‡§ï‡•ç‡§ü‡•ç‡§∏</label>    
                <input type="radio" class="btn-check" name="effectsOption" id="templateEffectsRadio" autocomplete="off">    
                <label class="btn btn-outline-primary" for="templateEffectsRadio">‡§∞‡•á‡§°‡•Ä‡§Æ‡•á‡§° ‡§ü‡•á‡§Æ‡•ç‡§™‡§≤‡•á‡§ü‡•ç‡§∏</label>    
                <input type="radio" class="btn-check" name="effectsOption" id="customCodeRadio" autocomplete="off">    
                <label class="btn btn-outline-primary" for="customCodeRadio">‡§ï‡§∏‡•ç‡§ü‡§Æ ‡§ï‡•ã‡§°</label>    
            </div>    
        </div>    

        <div id="customEffectsSection">    
            <div class="row">    
                <div class="col-md-6 mb-3">    
                    <label for="shadowColor" class="form-label">‡§∂‡•à‡§°‡•ã ‡§∞‡§Ç‡§ó</label>    
                    <div id="shadowColorPicker"></div>
                </div>    
                <div class="col-md-6 mb-3">    
                    <label for="shadowBlur" class="form-label">‡§∂‡•à‡§°‡•ã ‡§¨‡•ç‡§≤‡§∞</label>    
                    <input type="number" class="form-control" id="shadowBlur" value="10" min="0" max="50">    
                </div>    
                <div class="col-md-6 mb-3">    
                    <label for="shadowOffsetX" class="form-label">‡§∂‡•à‡§°‡•ã ‡§ë‡§´‡§∏‡•á‡§ü X</label>    
                    <input type="number" class="form-control" id="shadowOffsetX" value="0" min="-50" max="50">    
                </div>    
                <div class="col-md-6 mb-3">    
                    <label for="shadowOffsetY" class="form-label">‡§∂‡•à‡§°‡•ã ‡§ë‡§´‡§∏‡•á‡§ü Y</label>    
                    <input type="number" class="form-control" id="shadowOffsetY" value="0" min="-50" max="50">    
                </div>    
                <div class="col-md-6 mb-3">    
                    <label for="backgroundColor" class="form-label">‡§¨‡•à‡§ï‡§ó‡•ç‡§∞‡§æ‡§â‡§Ç‡§° ‡§∞‡§Ç‡§ó</label>    
                    <div id="backgroundColorPicker"></div>
                </div>    
                <div class="col-md-6 mb-3">    
                    <label for="borderColor" class="form-label">‡§¨‡•â‡§∞‡•ç‡§°‡§∞ ‡§∞‡§Ç‡§ó</label>    
                    <div id="borderColorPicker"></div>
                </div>    
                <div class="col-md-6 mb-3">    
                    <label for="borderWidth" class="form-label">‡§¨‡•â‡§∞‡•ç‡§°‡§∞ ‡§ö‡•å‡§°‡§º‡§æ‡§à</label>    
                    <input type="number" class="form-control" id="borderWidth" value="0" min="0" max="10">    
                </div>    
            </div>    
        </div>    

        <div id="templateEffectsSection" style="display: none;">    
            <div id="chartEffectsTemplateGallery" class="d-flex flex-wrap gap-2 justify-content-center mt-3"></div>    
        </div>    

        <div id="customCodeEffectsSection" style="display: none;">    
            <p class="text-muted small">‡§Ø‡§π‡§æ‡§Å JSON ‡§´‡•â‡§∞‡•ç‡§Æ‡•á‡§ü ‡§Æ‡•á‡§Ç ‡§á‡•û‡•á‡§ï‡•ç‡§ü ‡§ï‡•ã‡§° ‡§°‡§æ‡§≤‡•á‡§Ç‡•§</p>    
            <div class="input-group">    
                <textarea id="customEffectCode" class="form-control" rows="12" placeholder="‡§â‡§¶‡§æ‡§π‡§∞‡§£: { &quot;shadowColor&quot;: &quot;rgba(255, 99, 132, 0.4)&quot;, ... }"></textarea>    
                <button class="btn btn-outline-secondary" type="button" id="openChartEffectEditorBtn" data-bs-toggle="modal" data-bs-target="#codeEditorModal"><i class="bi bi-arrows-fullscreen"></i></button>    
            </div>    
            <div class="alert alert-danger mt-2" id="codeErrorAlert" style="display: none;"></div>    
        </div>    

        <div class="mb-3 mt-3">    
            <label class="form-label">‡§á‡•û‡•á‡§ï‡•ç‡§ü ‡§≤‡§æ‡§ó‡•Ç ‡§ï‡§∞‡•á‡§Ç:</label>    
            <div class="btn-group w-100" role="group" aria-label="‡§á‡•û‡•á‡§ï‡•ç‡§ü ‡§∏‡•ç‡§ï‡•ã‡§™">    
                <input type="radio" class="btn-check" name="effectScope" id="applyToAllRadio" autocomplete="off" checked>    
                <label class="btn btn-outline-secondary" for="applyToAllRadio">‡§∏‡§≠‡•Ä ‡§ö‡§æ‡§∞‡•ç‡§ü ‡§™‡§∞</label>    
                <input type="radio" class="btn-check" name="effectScope" id="applyToSelectedRadio" autocomplete="off">    
                <label class="btn btn-outline-secondary" for="applyToSelectedRadio">‡§ö‡§Ø‡§®‡§ø‡§§ ‡§ö‡§æ‡§∞‡•ç‡§ü ‡§™‡§∞</label>    
            </div>    
        </div>    
        <div id="dashboardChartOverviewEffects" style="display: none;">    
            <label class="form-label"><i class="bi bi-list-check"></i> ‡§ö‡§æ‡§∞‡•ç‡§ü ‡§ö‡•Å‡§®‡•á‡§Ç:</label>    
            <div id="chartSelectionListEffects" class="form-control" style="max-height: 200px; overflow-y: auto;"></div>    
        </div>    
        <button id="applyChartEffects" class="btn btn-primary mt-3 w-100"><i class="bi bi-check-circle"></i> ‡§á‡§´‡•á‡§ï‡•ç‡§ü‡•ç‡§∏ ‡§≤‡§æ‡§ó‡•Ç ‡§ï‡§∞‡•á‡§Ç</button>    
    </div>    
</div>    


               
                <div id="textboxContent" class="offcanvas-content" style="display: none;">
                    <h5 class="mb-3"><i class="bi bi-textarea-t"></i> ‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü‡§¨‡•â‡§ï‡•ç‡§∏ ‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó‡•ç‡§∏</h5>
                    <div class="control-panel p-0">
                        <h6>‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü‡§¨‡•â‡§ï‡•ç‡§∏ ‡§ì‡§µ‡§∞‡§µ‡•ç‡§Ø‡•Ç</h6>
                        <div id="textboxList" class="list-group mb-3" style="max-height: 200px; overflow-y: auto;">
                            </div>

                        <div id="textboxPreview" class="box-preview">
                            <div class="ql-editor"></div>
                        </div>
                        <hr>
                        <h6>‡§è‡§°‡§ø‡§ü‡§∞</h6>
                        <div class="controls-group">
                            <div class="d-flex align-items-center mb-3">
                                <div>
                                    <label for="bgColorPicker" class="form-label mb-0">Background Color</label>
                                    <input type="color" class="form-control form-control-color" id="bgColorPicker" value="#ffffff" title="Background Color">
                                </div>
                                
                                <button id="dataInsertButton" type="button" class="btn btn-outline-primary ms-3" title="Insert Live Data Field">
                                    <i class="bi bi-database-fill me-1"></i> Data Insert
                                </button>
                            </div>
                        </div>

                        <div id="quill-container" style="height: 300px;"></div>
                        <button id="mainActionButton" class="btn btn-primary w-100"><i class="bi bi-plus-square"></i>Create a new texbox</button>
                    </div>
                    <hr>
                    <h6>Ready Made Templates</h6>
                    <p class="text-muted small">‡§è‡§ï ‡§ü‡•á‡§Æ‡•ç‡§™‡§≤‡•á‡§ü ‡§™‡§∞ ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§â‡§∏‡•á ‡§Ö‡§™‡§®‡•á ‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§° ‡§Æ‡•á‡§Ç ‡§ú‡•ã‡§°‡§º‡•á‡§Ç‡•§</p>
                    <div id="templateGallery" class="d-flex flex-wrap gap-2 justify-content-center">
                        </div>
                </div>

                <div id="userInfoContent" class="offcanvas-content" style="display: none;">
                    <h5 class="mb-3"><i class="bi bi-person-circle"></i> Profile</h5>
                    <div id="userInfo" class="alert alert-success d-flex align-items-center" style="display: none;">
                        <i class="bi bi-person-circle me-2"></i>
                        <span id="userEmail"></span>
                        <button id="logoutBtn" class="btn btn-danger btn-sm ms-auto"><i class="bi bi-box-arrow-right"></i> Log out</button>
                    </div>
                    <p class="text-muted mt-3">‡§Ö‡§™‡§®‡•Ä ‡§™‡•ç‡§∞‡•ã‡§´‡§º‡§æ‡§á‡§≤ ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§Ø‡§π‡§æ‡§Ç ‡§¶‡•á‡§ñ‡•á‡§Ç‡•§</p>
                </div>
            </div>
        </div>
        
        <div class="container-fluid main-content-container py-4 flex-grow-1">
            <div id="dashboardSection" class="content-section active">
                <div id="visualizationsSection" class="section-card">
                    <h3 class="mt-4"><i class="bi bi-bar-chart-line"></i> Visualizations</h3>
                    <div id="visualizations" class="position-relative" style="min-height: 500px; border: 1px dashed #ccc; padding: 10px;">
                        <div class="no-charts-message text-muted text-center p-4">
                            <p><i class="bi bi-info-circle"></i> ‡§ï‡•ã‡§à ‡§ö‡§æ‡§∞‡•ç‡§ü ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§</p>
                            <p>‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó‡•ç‡§∏ ‡§∏‡•á '‡§ö‡§æ‡§∞‡•ç‡§ü' ‡§Æ‡•á‡§Ç ‡§ú‡§æ‡§ï‡§∞ ‡§ö‡§æ‡§∞‡•ç‡§ü ‡§ú‡•ã‡§°‡§º‡•á‡§Ç‡•§</p>
                        </div>
                        </div>
                </div>
                <hr>
                <!div id="dataTableSection" class="section-card">
                   
                    <!div class="table-responsive" style="max-height:400px; overflow:auto;">
                        <div id="dataTableContainer">
                            </div>
                    </div>
                

                <hr>
                <div id="summaryOutputSection" class="section-card">
                    <h3><i class="bi bi-lightbulb"></i> AI ‡§∏‡§æ‡§∞‡§æ‡§Ç‡§∂</h3>
                    <div class="alert alert-info mt-3" id="summaryOutput">
                        <p><strong>AI ‡§∏‡§æ‡§∞‡§æ‡§Ç‡§∂:</strong></p>
                        <div id="summaryText">
                            </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="offcanvas offcanvas-end" tabindex="-1" id="dataInsertSidebar" aria-labelledby="dataInsertSidebarLabel" style="width: 450px; z-index: 1055;">
        <div class="offcanvas-header bg-primary text-white">
            <h5 class="offcanvas-title" id="dataInsertSidebarLabel"><i class="bi bi-database-fill me-2"></i> Live Data Insertion</h5>
            <button type="button" class="btn-close btn-close-white" id="closeDataSidebarBtn" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body d-flex flex-column">
            <p class="text-muted small">‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü‡§¨‡•â‡§ï‡•ç‡§∏ ‡§Æ‡•á‡§Ç ‡§°‡§æ‡§≤‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§µ‡§ø‡§∂‡§ø‡§∑‡•ç‡§ü **‡§°‡•á‡§ü‡§æ ‡§™‡§Ç‡§ï‡•ç‡§§‡§ø‡§Ø‡•ã‡§Ç (Data Rows)** ‡§ï‡§æ ‡§ö‡§Ø‡§® ‡§ï‡§∞‡•á‡§Ç‡•§ (‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞‡•ç‡§° ‡§°‡•á‡§ü‡§æ ‡§ï‡•Ä ‡§™‡§π‡§≤‡•Ä 50 ‡§™‡§Ç‡§ï‡•ç‡§§‡§ø‡§Ø‡§æ‡§Å ‡§¶‡§ø‡§ñ‡§æ ‡§∞‡§π‡§æ ‡§π‡•à)</p>
            
            <div id="dataListContainer" class="flex-grow-1 overflow-auto p-2 border rounded mb-3 bg-light" style="max-height: 80%;">
                <p class="text-center text-muted p-5">‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</p>
            </div>

            <button id="insertSelectedDataBtn" class="btn btn-success w-100 mt-auto">
                <i class="bi bi-box-arrow-in-down me-2"></i> ‡§ö‡§Ø‡§®‡§ø‡§§ ‡§°‡•á‡§ü‡§æ ‡§™‡§Ç‡§ï‡•ç‡§§‡§ø‡§Ø‡§æ‡§Å ‡§á‡§®‡•ç‡§∏‡§∞‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç
            </button>
        </div>
    </div>
    <div id="luckysheetSection" class="luckysheet-section" style="display: none;">
        <div id="luckysheet-container"></div>
        <div class="d-flex justify-content-end p-2 border-top bg-light">
            <button id="saveLuckysheetData" class="btn btn-success me-2"><i class="bi bi-save"></i> ‡§°‡•á‡§ü‡§æ ‡§∏‡•á‡§µ ‡§ï‡§∞‡•á‡§Ç</button>
            <button id="closeLuckysheet" class="btn btn-secondary"><i class="bi bi-x-circle"></i> ‡§¨‡§Ç‡§¶ ‡§ï‡§∞‡•á‡§Ç</button>
        </div>
    </div>

    <div id="chatPopup" class="chat-popup">
        <div class="chat-popup-header">
            <span><i class="bi bi-chat-dots"></i> AI ‡§ö‡•à‡§ü ‡§Ö‡§∏‡§ø‡§∏‡•ç‡§ü‡•á‡§Ç‡§ü</span>
            <div class="header-controls">
                <button id="clearChatBtn" class="btn btn-sm btn-outline-secondary me-2" title="‡§ö‡•à‡§ü ‡§á‡§§‡§ø‡§π‡§æ‡§∏ ‡§∏‡§æ‡§´‡§º ‡§ï‡§∞‡•á‡§Ç">
                    <i class="bi bi-trash"></i> ‡§∏‡§æ‡§´‡§º ‡§ï‡§∞‡•á‡§Ç
                </button>
                <button id="closeChatBtn" class="close-btn" title="‡§¨‡§Ç‡§¶ ‡§ï‡§∞‡•á‡§Ç">&times;</button>
            </div>
        </div>
        <div class="chat-popup-body">
            <div id="chatHistory" class="chat-history mb-3">
                <div class="alert alert-info alert-dismissible fade show" role="alert">
                    <strong>‡§∏‡•ç‡§µ‡§æ‡§ó‡§§ ‡§π‡•à! üëã</strong> ‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•Ä ‡§°‡•á‡§ü‡§æ ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§Æ‡•á‡§Ç ‡§∏‡§π‡§æ‡§Ø‡§§‡§æ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ø‡§π‡§æ‡§Å ‡§π‡•Ç‡§Å‡•§ ‡§Ü‡§™ ‡§°‡•á‡§ü‡§æ ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§ï‡•ã‡§à ‡§≠‡•Ä ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§™‡•Ç‡§õ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
                </div>
        </div>
        <div class="chat-popup-footer">
            <div class="input-group">
                <textarea id="chatInput" class="form-control" placeholder="‡§Ö‡§™‡§®‡§æ ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§™‡•Ç‡§õ‡•á‡§Ç... " rows="1"></textarea>
                <button id="sendChatBtn" class="btn btn-primary">
                    <i class="bi bi-send"></i> ‡§≠‡•á‡§ú‡•á‡§Ç
                </button>
            </div>
            <div class="chat-footer-info">
                <small class="text-muted">
                    <i class="bi bi-info-circle"></i> ‡§ö‡•à‡§ü ‡§Æ‡•ã‡§° ‡§Æ‡•á‡§Ç AI ‡§Ü‡§™‡§ï‡•á ‡§Ö‡§™‡§≤‡•ã‡§° ‡§ï‡§ø‡§è ‡§ó‡§è ‡§°‡•á‡§ü‡§æ ‡§î‡§∞ ‡§™‡§ø‡§õ‡§≤‡•á ‡§∏‡§Ç‡§µ‡§æ‡§¶‡•ã‡§Ç ‡§ï‡•á ‡§Ü‡§ß‡§æ‡§∞ ‡§™‡§∞ ‡§ú‡§µ‡§æ‡§¨ ‡§¶‡•á‡§ó‡§æ‡•§
                </small>
                <small class="text-muted d-block mt-1">
                    ‡§∏‡§Ç‡§¶‡•á‡§∂: <span id="charCount">0</span>/1000
                </small>
            </div>
        </div>
    </div>

    <div class="modal fade" id="codeEditorModal" tabindex="-1" aria-labelledby="codeEditorModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-fullscreen">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="codeEditorModalLabel">Castom Code editor</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body bg-dark text-white p-0">
                    <div id="editorContainer" style="height: 100%; width: 100%;">
                        </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-success" id="saveCodeBtn"><i class="bi bi-save"></i> ‡§ï‡•ã‡§° ‡§∏‡§π‡•á‡§ú‡•á‡§Ç</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="addDataModal" tabindex="-1" aria-labelledby="addDataModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addDataModalLabel"><i class="bi bi-plus-square"></i> ‡§®‡§Ø‡§æ ‡§°‡•á‡§ü‡§æ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="addDataForm">
                    </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" id="saveData"><i class="bi bi-save"></i> ‡§∏‡§π‡•á‡§ú‡•á‡§Ç</button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="modal fade" id="mainMenuModal" tabindex="-1" aria-labelledby="mainMenuModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="mainMenuModalLabel"></h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="dataContent" class="modal-content-area" style="display: none;">
                        <h5 class="modal-title" id="dataModalLabel"><i class="bi bi-file-earmark-arrow-up"></i> ‡§°‡•á‡§ü‡§æ ‡§Ö‡§™‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç</h5>
                        <div class="row gy-3 mb-4">
                            <div class="col-md-12">
                                <label for="fileInput"><i class="bi bi-file-earmark"></i> ‡§´‡§º‡§æ‡§á‡§≤ (CSV/Excel):</label>
                                <input type="file" id="fileInput" class="form-control" accept=".csv, .xlsx, .xls">
                            </div>
                            <div class="col-md-12 mt-4">
                                <h6 class="mb-3">‡§≤‡§æ‡§á‡§µ ‡§°‡•á‡§ü‡§æ ‡§Ö‡§™‡§≤‡•ã‡§°</h6>
                                <div class="mb-3">
                                    <label for="apiInput" class="form-label">API URL</label>
                                    <input type="url" class="form-control" id="apiInput" placeholder="https://api.example.com/data">
                                </div>
                                <div class="mb-3">
                                    <label for="updateInterval" class="form-label">‡§Ö‡§™‡§°‡•á‡§ü ‡§á‡§Ç‡§ü‡§∞‡§µ‡§≤ (‡§∏‡•á‡§ï‡§Ç‡§° ‡§Æ‡•á‡§Ç)</label>
                                    <input type="number" class="form-control" id="updateInterval" value="60">
                                </div>
                                <div class="d-flex justify-content-between">
                                    <button id="fetchDataFromApiBtn" class="btn btn-primary"><i class="bi bi-play-circle"></i> ‡§≤‡§æ‡§á‡§µ ‡§°‡•á‡§ü‡§æ ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç</button>
                                    <button id="stopLiveUpdateBtn" class="btn btn-danger"><i class="bi bi-stop-circle"></i> ‡§Ö‡§™‡§°‡•á‡§ü ‡§∞‡•ã‡§ï‡•á‡§Ç</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="advancedSettingsContent" class="modal-content-area" style="display: none;">
                        <h5 class="mb-3"><i class="bi bi-sliders"></i> ‡§è‡§°‡§µ‡§æ‡§Ç‡§∏‡•ç‡§° ‡§ö‡§æ‡§∞‡•ç‡§ü ‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó‡•ç‡§∏</h5>
                        <div id="advancedChartSettings">
                            <div class="mb-3 form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="gridShowHide" checked>
                                <label class="form-check-label" for="gridShowHide">‡§ó‡•ç‡§∞‡§ø‡§° ‡§¶‡§ø‡§ñ‡§æ‡§è‡§Å/‡§õ‡§ø‡§™‡§æ‡§è‡§Å</label>
                            </div>
                            <div class="mb-3 form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="tooltipOnOff" checked>
                                <label class="form-check-label" for="tooltipOnOff">‡§ü‡•Ç‡§≤‡§ü‡§ø‡§™ ‡§ö‡§æ‡§≤‡•Ç/‡§¨‡§Ç‡§¶</label>
                            </div>
                            <div class="mb-3 form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="zoomEnable">
                                <label class="form-check-label" for="zoomEnable">‡§ú‡§º‡•Ç‡§Æ ‡§∏‡§ï‡•ç‡§∑‡§Æ ‡§ï‡§∞‡•á‡§Ç</label>
                            </div>
                            <div class="mb-3">
                                <label for="animationDuration" class="form-label">‡§è‡§®‡•Ä‡§Æ‡•á‡§∂‡§® ‡§Ö‡§µ‡§ß‡§ø (‡§Æ‡§ø‡§≤‡•Ä‡§∏‡•á‡§ï‡§Ç‡§°): <span id="animationDurationValue">1000</span></label>
                                <input type="range" class="form-range" id="animationDuration" min="0" max="3000" value="1000" step="100">
                            </div>
                            <div class="mb-3">
                                <label for="axisFormat" class="form-label">‡§è‡§ï‡•ç‡§∏‡§ø‡§∏ ‡§´‡•â‡§∞‡•ç‡§Æ‡•á‡§ü:</label>
                                <select class="form-select" id="axisFormat">
                                    <option value="none">‡§ï‡•ã‡§à ‡§®‡§π‡•Ä‡§Ç</option>
                                    <option value="compact">‡§ï‡•â‡§Æ‡•ç‡§™‡•à‡§ï‡•ç‡§ü (‡§ú‡•à‡§∏‡•á 1K, 1M)</option>
                                    <option value="currency">‡§ï‡§∞‡•á‡§Ç‡§∏‡•Ä (‡§ú‡•à‡§∏‡•á ‚Çπ1,000)</option>
                                    <option value="percent">‡§™‡•ç‡§∞‡§§‡§ø‡§∂‡§§ (‡§ú‡•à‡§∏‡•á 10%)</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label for="legendPosition" class="form-label">‡§≤‡•á‡§ú‡•á‡§Ç‡§° ‡§™‡•ã‡§ú‡•Ä‡§∂‡§®:</label>
                                <select class="form-select" id="legendPosition">
                                    <option value="bottom">‡§®‡•Ä‡§ö‡•á</option>
                                    <option value="top">‡§ä‡§™‡§∞</option>
                                    <option value="left">‡§¨‡§æ‡§è‡§Ç</option>
                                    <option value="right">‡§¶‡§æ‡§è‡§Ç</option>
                                    <option value="none">‡§ï‡•ã‡§à ‡§®‡§π‡•Ä‡§Ç</option>
                                </select>
                            </div>
                            <div class="mb-3 form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="showLabels" checked>
                                <label class="form-check-label" for="showLabels">‡§≤‡•á‡§¨‡§≤ ‡§¶‡§ø‡§ñ‡§æ‡§è‡§Å</label>
                            </div>
                            <div class="mb-3">
                                <button id="applyChartSettings" class="btn btn-primary w-100"><i class="bi bi-check-circle"></i> ‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó‡•ç‡§∏ ‡§≤‡§æ‡§ó‡•Ç ‡§ï‡§∞‡•á‡§Ç</button>
                            </div>
                        </div>
                    </div>

                    <div id="dataStatisticsContent" class="modal-content-area" style="display: none;">
                        <h5 class="mb-3"><i class="bi bi-calculator"></i> ‡§°‡•á‡§ü‡§æ ‡§∏‡§æ‡§Ç‡§ñ‡•ç‡§Ø‡§ø‡§ï‡•Ä</h5>
                        <div id="statsSection">
                            <select id="statsCol" class="form-select mb-2 w-100">
                                <option value="">‡§ï‡•â‡§≤‡§Æ ‡§ö‡•Å‡§®‡•á‡§Ç</option>
                                </select>
                            <div id="statsOutput">
                                </div>
                        </div>
                    </div>

                    <div id="dashboardViewContent" class="modal-content-area" style="display: none;">
                        <h5 class="mb-3"><i class="bi bi-eye"></i> ‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§° ‡§¶‡•É‡§∂‡•ç‡§Ø</h5>
                        <div id="dashboardViewSection">
                            <div class="mb-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="" id="toggleVisualizations" checked>
                                    <label class="form-check-label" for="toggleVisualizations">
                                        ‡§µ‡§ø‡§ú‡§º‡•Å‡§Ö‡§≤‡§æ‡§á‡§ú‡§º‡•á‡§∂‡§® ‡§¶‡§ø‡§ñ‡§æ‡§è‡§Ç
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="" id="toggleDataTable" checked>
                                    <label class="form-check-label" for="toggleDataTable">
                                        ‡§°‡•á‡§ü‡§æ ‡§ü‡•á‡§¨‡§≤ ‡§¶‡§ø‡§ñ‡§æ‡§è‡§Ç
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="" id="toggleSummary" checked>
                                    <label class="form-check-label" for="toggleSummary">
                                        AI ‡§∏‡§æ‡§∞‡§æ‡§Ç‡§∂ ‡§¶‡§ø‡§ñ‡§æ‡§è‡§Ç
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="" id="toggleChat" checked>
                                    <label class="form-check-label" for="toggleChat">
                                        AI ‡§ö‡•à‡§ü ‡§¶‡§ø‡§ñ‡§æ‡§è‡§Ç
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-12 mt-4">
                                <button id="downloadFullDashboard" class="btn btn-dark w-100"><i class="bi bi-file-earmark-arrow-down"></i> ‡§™‡•Ç‡§∞‡§æ ‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§° ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    

    <div class="ai-advice-overlay"></div>
    <div class="ai-advice-container">
        <button id="closeAiAdviceBtn">&times;</button>
        <div id="aiAdviceContent">
            </div>
    </div>

    <button id="toggleLockModeBtn" class="btn btn-outline-secondary">
        <i class="bi bi-lock-fill"></i> Desbord Lock
    </button>
    <div id="openChatBtn" class="floating-chat-button">
        <i class="bi bi-chat-dots-fill"></i>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/luckysheet@latest/dist/plugins/js/plugin.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/luckysheet@latest/dist/luckysheet.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts-gl@2/dist/echarts-gl.min.js"></script>
    <script src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsPDF/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.23/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/showdown/dist/showdown.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/moveable/dist/moveable.min.js"></script>
    <script src="https://cdn.quilljs.com/1.3.7/quill.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/javascript/javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/lint/lint.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsonlint/1.6.0/jsonlint.min.js"></script>
    
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

    <script src="src/js/chatbot_Listener.js"></script>
    <script> </script>
    <script type="module" src="src/js/main.js"></script>
    
   
<!-- Pickr CSS + JS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@simonwep/pickr/dist/themes/classic.min.css"/>
<script src="https://cdn.jsdelivr.net/npm/@simonwep/pickr/dist/pickr.min.js"></script>
<script>

  const pickrOptions = (elId, defaultColor) => Pickr.create({
    el: '#' + elId,
    theme: 'classic',
    default: defaultColor,
    components: {
      preview: true,
      opacity: true,
      hue: true,
      interaction: { input: true, save: true }
    }
  });

  const shadowPickr = pickrOptions('shadowColorPicker', '#000000');
  const bgPickr = pickrOptions('backgroundColorPicker', '#ffffff');
  const borderPickr = pickrOptions('borderColorPicker', '#CCCCCC');

  const bindPickr = (pickrInstance, inputId) => {
    pickrInstance.on('save', (color, instance) => {
      document.getElementById(inputId).value = color.toHEXA().toString();
      instance.hide();
    });
    pickrInstance.on('change', (color) => {
      document.getElementById(inputId).value = color.toHEXA().toString();
    });
  };

  // Hidden inputs to store values
  ['shadowColor', 'backgroundColor', 'borderColor'].forEach(id => {
    if(!document.getElementById(id)){
      const inp = document.createElement('input');
      inp.type='hidden';
      inp.id=id;
      document.getElementById('customEffectsSection').appendChild(inp);
    }
  });

  bindPickr(shadowPickr, 'shadowColor');
  bindPickr(bgPickr, 'backgroundColor');
  bindPickr(borderPickr, 'borderColor');
</script>
</body>
</html>
